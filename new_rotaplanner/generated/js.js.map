{
  "version": 3,
  "sources": ["../ui/table/dragdrop.ts", "../ui/js.js"],
  "sourcesContent": ["function registerDraggable(\n  element: HTMLElement,\n  allowedTargets: string,\n  aborter?: AbortSignal\n) {\n  let droptarget: HTMLElement | null = null;\n  let maybedragging: boolean = false;\n  let isdragging: boolean = false;\n  let offsetX: number = 0;\n  let offsetY: number = 0;\n  element.addEventListener(\n    \"pointerdown\",\n    (event) => {\n      maybedragging = true;\n      event.stopPropagation();\n    },\n    { signal: aborter }\n  );\n  element.addEventListener(\n    \"pointermove\",\n    (event) => {\n      if (maybedragging && !isdragging) {\n        element.dispatchEvent(\n          new CustomEvent(\"begin-drag\", {\n            detail: { target: element,initialDropzone:element.closest(allowedTargets) },\n            bubbles: true,\n          })\n        );\n        offsetX = 0;\n        offsetY = 0;\n        element.setPointerCapture(event.pointerId);\n        isdragging = true;\n      }\n      if (isdragging) {\n        offsetX += event.movementX;\n        offsetY += event.movementY;\n        const droptargets = document.elementsFromPoint(\n          event.clientX,\n          event.clientY\n        ) as HTMLElement[];\n\n        droptarget =\n          droptargets.find(\n            (el) => el !== element && el.matches(allowedTargets || \"\")\n          ) ?? null;\n\n        element.style.transform = `translate(${offsetX}px, ${offsetY}px)`;\n\n        element.dispatchEvent(\n          new CustomEvent(\"dragging-over\", {\n            detail: { droptarget: droptarget },\n            bubbles: true,\n          })\n        );\n\n        // Handle drag move logic here\n      }\n    },\n    { signal: aborter }\n  );\n  element.addEventListener(\n    \"pointerup\",\n    (event) => {\n      maybedragging = false;\n      element.style.transform = \"\";\n      if (isdragging) {\n        isdragging = false;\n        element.releasePointerCapture(event.pointerId);\n        if (droptarget) {\n          droptarget.dispatchEvent(\n            new CustomEvent(\"dropped-on\", {\n              detail: { droppedElement: element },\n              bubbles: true,\n            })\n          );\n          element.dispatchEvent(\n            new CustomEvent(\"dropped\", {\n              detail: { droptarget: droptarget },\n              bubbles: true,\n            })\n          );\n        }\n      }\n    },\n    { signal: aborter }\n  );\n  element.addEventListener(\n    \"pointercancel\",\n    (event) => {\n      if (isdragging) {\n        element.dispatchEvent(\n          new CustomEvent(\"drag-cancelled\", {\n            detail: { target: element },\n            bubbles: true,\n          })\n        );\n      }\n      isdragging = false;\n      maybedragging = false;\n      element.style.transform = \"\";\n      element.releasePointerCapture(event.pointerId);\n    },\n    { signal: aborter }\n  );\n}\n\nexport default function (datastar) {\n  datastar.attribute({\n    name: \"draggable\",\n    requirement: {\n      key: \"denied\",\n      value: \"must\",\n    },\n    returnsValue: true,\n    apply({ el, rx }: { el: HTMLElement; rx: () => string }) {\n      const aborter = new AbortController();\n      registerDraggable(el, rx(), aborter.signal);\n\n      return () => aborter.abort();\n    },\n  });\n}\n", "import setupDragDrop from \"./table/dragdrop.ts\";\n\nexport function setupDataStar(datastarInstance) {\n  setupDragDrop(datastarInstance);\n}\n"],
  "mappings": ";AAAA,SAAS,kBACP,SACA,gBACA,SACA;AACA,MAAI,aAAiC;AACrC,MAAI,gBAAyB;AAC7B,MAAI,aAAsB;AAC1B,MAAI,UAAkB;AACtB,MAAI,UAAkB;AACtB,UAAQ;AAAA,IACN;AAAA,IACA,CAAC,UAAU;AACT,sBAAgB;AAChB,YAAM,gBAAgB;AAAA,IACxB;AAAA,IACA,EAAE,QAAQ,QAAQ;AAAA,EACpB;AACA,UAAQ;AAAA,IACN;AAAA,IACA,CAAC,UAAU;AACT,UAAI,iBAAiB,CAAC,YAAY;AAChC,gBAAQ;AAAA,UACN,IAAI,YAAY,cAAc;AAAA,YAC5B,QAAQ,EAAE,QAAQ,SAAQ,iBAAgB,QAAQ,QAAQ,cAAc,EAAE;AAAA,YAC1E,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AACA,kBAAU;AACV,kBAAU;AACV,gBAAQ,kBAAkB,MAAM,SAAS;AACzC,qBAAa;AAAA,MACf;AACA,UAAI,YAAY;AACd,mBAAW,MAAM;AACjB,mBAAW,MAAM;AACjB,cAAM,cAAc,SAAS;AAAA,UAC3B,MAAM;AAAA,UACN,MAAM;AAAA,QACR;AAEA,qBACE,YAAY;AAAA,UACV,CAAC,OAAO,OAAO,WAAW,GAAG,QAAQ,kBAAkB,EAAE;AAAA,QAC3D,KAAK;AAEP,gBAAQ,MAAM,YAAY,aAAa,OAAO,OAAO,OAAO;AAE5D,gBAAQ;AAAA,UACN,IAAI,YAAY,iBAAiB;AAAA,YAC/B,QAAQ,EAAE,WAAuB;AAAA,YACjC,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MAGF;AAAA,IACF;AAAA,IACA,EAAE,QAAQ,QAAQ;AAAA,EACpB;AACA,UAAQ;AAAA,IACN;AAAA,IACA,CAAC,UAAU;AACT,sBAAgB;AAChB,cAAQ,MAAM,YAAY;AAC1B,UAAI,YAAY;AACd,qBAAa;AACb,gBAAQ,sBAAsB,MAAM,SAAS;AAC7C,YAAI,YAAY;AACd,qBAAW;AAAA,YACT,IAAI,YAAY,cAAc;AAAA,cAC5B,QAAQ,EAAE,gBAAgB,QAAQ;AAAA,cAClC,SAAS;AAAA,YACX,CAAC;AAAA,UACH;AACA,kBAAQ;AAAA,YACN,IAAI,YAAY,WAAW;AAAA,cACzB,QAAQ,EAAE,WAAuB;AAAA,cACjC,SAAS;AAAA,YACX,CAAC;AAAA,UACH;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,IACA,EAAE,QAAQ,QAAQ;AAAA,EACpB;AACA,UAAQ;AAAA,IACN;AAAA,IACA,CAAC,UAAU;AACT,UAAI,YAAY;AACd,gBAAQ;AAAA,UACN,IAAI,YAAY,kBAAkB;AAAA,YAChC,QAAQ,EAAE,QAAQ,QAAQ;AAAA,YAC1B,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MACF;AACA,mBAAa;AACb,sBAAgB;AAChB,cAAQ,MAAM,YAAY;AAC1B,cAAQ,sBAAsB,MAAM,SAAS;AAAA,IAC/C;AAAA,IACA,EAAE,QAAQ,QAAQ;AAAA,EACpB;AACF;AAEe,SAAR,iBAAkB,UAAU;AACjC,WAAS,UAAU;AAAA,IACjB,MAAM;AAAA,IACN,aAAa;AAAA,MACX,KAAK;AAAA,MACL,OAAO;AAAA,IACT;AAAA,IACA,cAAc;AAAA,IACd,MAAM,EAAE,IAAI,GAAG,GAA0C;AACvD,YAAM,UAAU,IAAI,gBAAgB;AACpC,wBAAkB,IAAI,GAAG,GAAG,QAAQ,MAAM;AAE1C,aAAO,MAAM,QAAQ,MAAM;AAAA,IAC7B;AAAA,EACF,CAAC;AACH;;;ACvHO,SAAS,cAAc,kBAAkB;AAC9C,mBAAc,gBAAgB;AAChC;",
  "names": []
}
