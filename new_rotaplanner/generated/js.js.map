{
  "version": 3,
  "sources": ["../ui/table/dragdrop.ts", "../ui/js.js"],
  "sourcesContent": ["function registerDraggable(\r\n  element: HTMLElement,\r\n  allowedTargets: string,\r\n  aborter?: AbortSignal\r\n) {\r\n  let droptarget: HTMLElement | null = null;\r\n  let maybedragging: boolean = false;\r\n  let isdragging: boolean = false;\r\n  let offsetX: number = 0;\r\n  let offsetY: number = 0;\r\n  element.addEventListener(\r\n    \"pointerdown\",\r\n    (event) => {\r\n      maybedragging = true;\r\n      event.stopPropagation();\r\n    },\r\n    { signal: aborter }\r\n  );\r\n  element.addEventListener(\r\n    \"pointermove\",\r\n    (event) => {\r\n      if (maybedragging && !isdragging) {\r\n        element.dispatchEvent(\r\n          new CustomEvent(\"begin-drag\", {\r\n            detail: { target: element,initialDropzone:element.closest(allowedTargets) },\r\n            bubbles: true,\r\n          })\r\n        );\r\n        offsetX = 0;\r\n        offsetY = 0;\r\n        element.setPointerCapture(event.pointerId);\r\n        isdragging = true;\r\n      }\r\n      if (isdragging) {\r\n        offsetX += event.movementX;\r\n        offsetY += event.movementY;\r\n        const droptargets = document.elementsFromPoint(\r\n          event.clientX,\r\n          event.clientY\r\n        ) as HTMLElement[];\r\n\r\n        droptarget =\r\n          droptargets.find(\r\n            (el) => el !== element && el.matches(allowedTargets || \"\")\r\n          ) ?? null;\r\n\r\n        element.style.transform = `translate(${offsetX}px, ${offsetY}px)`;\r\n\r\n        element.dispatchEvent(\r\n          new CustomEvent(\"dragging-over\", {\r\n            detail: { droptarget: droptarget },\r\n            bubbles: true,\r\n          })\r\n        );\r\n\r\n        // Handle drag move logic here\r\n      }\r\n    },\r\n    { signal: aborter }\r\n  );\r\n  element.addEventListener(\r\n    \"pointerup\",\r\n    (event) => {\r\n      maybedragging = false;\r\n      element.style.transform = \"\";\r\n      if (isdragging) {\r\n        isdragging = false;\r\n        element.releasePointerCapture(event.pointerId);\r\n        if (droptarget) {\r\n          droptarget.dispatchEvent(\r\n            new CustomEvent(\"dropped-on\", {\r\n              detail: { droppedElement: element },\r\n              bubbles: true,\r\n            })\r\n          );\r\n          element.dispatchEvent(\r\n            new CustomEvent(\"dropped\", {\r\n              detail: { droptarget: droptarget },\r\n              bubbles: true,\r\n            })\r\n          );\r\n        }\r\n      }\r\n    },\r\n    { signal: aborter }\r\n  );\r\n  element.addEventListener(\r\n    \"pointercancel\",\r\n    (event) => {\r\n      if (isdragging) {\r\n        element.dispatchEvent(\r\n          new CustomEvent(\"drag-cancelled\", {\r\n            detail: { target: element },\r\n            bubbles: true,\r\n          })\r\n        );\r\n      }\r\n      isdragging = false;\r\n      maybedragging = false;\r\n      element.style.transform = \"\";\r\n      element.releasePointerCapture(event.pointerId);\r\n    },\r\n    { signal: aborter }\r\n  );\r\n}\r\n\r\nexport default function (datastar) {\r\n  datastar.attribute({\r\n    name: \"draggable\",\r\n    requirement: {\r\n      key: \"denied\",\r\n      value: \"must\",\r\n    },\r\n    returnsValue: true,\r\n    apply({ el, rx }: { el: HTMLElement; rx: () => string }) {\r\n      const aborter = new AbortController();\r\n      registerDraggable(el, rx(), aborter.signal);\r\n\r\n      return () => aborter.abort();\r\n    },\r\n  });\r\n}\r\n", "import setupDragDrop from \"./table/dragdrop.ts\";\r\n\r\nexport function setupDataStar(datastarInstance) {\r\n  setupDragDrop(datastarInstance);\r\n}\r\n"],
  "mappings": ";AAAA,SAAS,kBACP,SACA,gBACA,SACA;AACA,MAAI,aAAiC;AACrC,MAAI,gBAAyB;AAC7B,MAAI,aAAsB;AAC1B,MAAI,UAAkB;AACtB,MAAI,UAAkB;AACtB,UAAQ;AAAA,IACN;AAAA,IACA,CAAC,UAAU;AACT,sBAAgB;AAChB,YAAM,gBAAgB;AAAA,IACxB;AAAA,IACA,EAAE,QAAQ,QAAQ;AAAA,EACpB;AACA,UAAQ;AAAA,IACN;AAAA,IACA,CAAC,UAAU;AACT,UAAI,iBAAiB,CAAC,YAAY;AAChC,gBAAQ;AAAA,UACN,IAAI,YAAY,cAAc;AAAA,YAC5B,QAAQ,EAAE,QAAQ,SAAQ,iBAAgB,QAAQ,QAAQ,cAAc,EAAE;AAAA,YAC1E,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AACA,kBAAU;AACV,kBAAU;AACV,gBAAQ,kBAAkB,MAAM,SAAS;AACzC,qBAAa;AAAA,MACf;AACA,UAAI,YAAY;AACd,mBAAW,MAAM;AACjB,mBAAW,MAAM;AACjB,cAAM,cAAc,SAAS;AAAA,UAC3B,MAAM;AAAA,UACN,MAAM;AAAA,QACR;AAEA,qBACE,YAAY;AAAA,UACV,CAAC,OAAO,OAAO,WAAW,GAAG,QAAQ,kBAAkB,EAAE;AAAA,QAC3D,KAAK;AAEP,gBAAQ,MAAM,YAAY,aAAa,OAAO,OAAO,OAAO;AAE5D,gBAAQ;AAAA,UACN,IAAI,YAAY,iBAAiB;AAAA,YAC/B,QAAQ,EAAE,WAAuB;AAAA,YACjC,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MAGF;AAAA,IACF;AAAA,IACA,EAAE,QAAQ,QAAQ;AAAA,EACpB;AACA,UAAQ;AAAA,IACN;AAAA,IACA,CAAC,UAAU;AACT,sBAAgB;AAChB,cAAQ,MAAM,YAAY;AAC1B,UAAI,YAAY;AACd,qBAAa;AACb,gBAAQ,sBAAsB,MAAM,SAAS;AAC7C,YAAI,YAAY;AACd,qBAAW;AAAA,YACT,IAAI,YAAY,cAAc;AAAA,cAC5B,QAAQ,EAAE,gBAAgB,QAAQ;AAAA,cAClC,SAAS;AAAA,YACX,CAAC;AAAA,UACH;AACA,kBAAQ;AAAA,YACN,IAAI,YAAY,WAAW;AAAA,cACzB,QAAQ,EAAE,WAAuB;AAAA,cACjC,SAAS;AAAA,YACX,CAAC;AAAA,UACH;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,IACA,EAAE,QAAQ,QAAQ;AAAA,EACpB;AACA,UAAQ;AAAA,IACN;AAAA,IACA,CAAC,UAAU;AACT,UAAI,YAAY;AACd,gBAAQ;AAAA,UACN,IAAI,YAAY,kBAAkB;AAAA,YAChC,QAAQ,EAAE,QAAQ,QAAQ;AAAA,YAC1B,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MACF;AACA,mBAAa;AACb,sBAAgB;AAChB,cAAQ,MAAM,YAAY;AAC1B,cAAQ,sBAAsB,MAAM,SAAS;AAAA,IAC/C;AAAA,IACA,EAAE,QAAQ,QAAQ;AAAA,EACpB;AACF;AAEe,SAAR,iBAAkB,UAAU;AACjC,WAAS,UAAU;AAAA,IACjB,MAAM;AAAA,IACN,aAAa;AAAA,MACX,KAAK;AAAA,MACL,OAAO;AAAA,IACT;AAAA,IACA,cAAc;AAAA,IACd,MAAM,EAAE,IAAI,GAAG,GAA0C;AACvD,YAAM,UAAU,IAAI,gBAAgB;AACpC,wBAAkB,IAAI,GAAG,GAAG,QAAQ,MAAM;AAE1C,aAAO,MAAM,QAAQ,MAAM;AAAA,IAC7B;AAAA,EACF,CAAC;AACH;;;ACvHO,SAAS,cAAc,kBAAkB;AAC9C,mBAAc,gBAAgB;AAChC;",
  "names": []
}
